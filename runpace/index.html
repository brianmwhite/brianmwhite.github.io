<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="apple-touch-icon" href="./apple-touch-icon.png">
    <link rel="canonical" href="https://www.thirdember.com/runpace/" />
    <link rel="manifest" href="./manifest.webmanifest">
    <script type="module" src="./main.js"></script>
    <title>RunCalc</title>
</head>

<body>
    <link rel="stylesheet" href="./styles.css" />
    <fieldset>
        <div>
            <label>Pace[min/mi]:
                <input type="number" inputmode="decimal" id="pace" name="pace" pattern="^[0-9]+(?:\.[0-9]{2})?$"
                    autofocus />
            </label>
            <button class="buttonType" type="reset" id="resetAmount" onclick="resetInput('pace')">&times;</button>
        </div>
        <table id="runPaceResultsTable">
            <thead>
                <tr>
                    <th>5K<br /><span class="secondary">10K</span></th>
                    <th>min<br />/mi</th>
                    <th>min<br />/km</th>
                    <th>mi<br />/hr</th>
                    <th>km<br />/hr</th>
                </tr>
            </thead>
            <tbody id="runPaceResultsBody">
            </tbody>
        </table>
    </fieldset>
    <script type="text/javascript" src="./calc.js"></script>
    <script>
        function resetInput(inputId) {
            const input = document.getElementById(inputId);
            input.value = "";
            clearTable();
            input.focus();
        }
        function insertRunPaceRow(tableBody, calc) {
            let newRow = tableBody.insertRow();

            let total5k10kCol = newRow.insertCell(-1);
            let minMiCol = newRow.insertCell(-1);
            let minKmCol = newRow.insertCell(-1);
            let miHourCol = newRow.insertCell(-1);
            let kmHourCol = newRow.insertCell(-1);

            total5k10kCol.innerHTML = calc.Estimated5KTotalTimeFormatted + "<br /><span class='secondary'>" + calc.Estimated10TotalTimeFormatted + "</span>";
            minMiCol.innerHTML = calc.MinutesPerMileOriginal;
            minKmCol.innerHTML = calc.MinutesPerKilometerFormatted;
            miHourCol.innerHTML = calc.MilesPerHour.toFixed(1);
            kmHourCol.innerHTML = calc.KmPerHour.toFixed(1);
        }
        function recalculatePace() {
            const input = document.getElementById("pace").value;
            clearTable();

            let tableBody = document.getElementById("runPaceResultsBody");
            if (input != "") {
                let calc = new PaceCalc(input);

                const TargetSecondsUp = PaceCalc.RoundUpToNearest(calc.SecondsPerMile / 60, 0.5) * 60;
                const TargetSecondsDown = PaceCalc.RoundDownToNearest(calc.SecondsPerMile / 60, 0.5) * 60;
                const TargetMinutesUp = PaceCalc.formatDurationFromSeconds(TargetSecondsUp);
                const TargetMinutesDown = PaceCalc.formatDurationFromSeconds(TargetSecondsDown);

                insertRunPaceRow(tableBody, new PaceCalc(TargetMinutesDown));
                insertRunPaceRow(tableBody, calc);
                insertRunPaceRow(tableBody, new PaceCalc(TargetMinutesUp));
            }
        }
        function clearTable() {
            let tableBody = document.getElementById("runPaceResultsBody");
            tableBody.innerHTML = "";
        }
        window.onload = function () {
            document.getElementById("pace").addEventListener("input", recalculatePace);
        };
    </script>
</body>

</html>